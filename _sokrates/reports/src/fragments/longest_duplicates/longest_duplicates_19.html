coverage/api/user/register/route.ts.html [274:363]:
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
&nbsp;
    const missingFields = [
      ["email", email],
      ["password", password],
      ["country", country],
      ["name", name],
    ]
      .filter(([, value]) =&gt; !value)
      .map(([field]) =&gt; field);
&nbsp;
    if (missingFields.length &gt; 0) {
      return Response.json(
        {
          message: `Missing required fields: ${missingFields.join(", ")}`,
        },
        {
          status: 400,
          headers: { "x-referer": referer },
        },
      );
    }
&nbsp;
    const birthdayDate = birthday ? new Date(birthday) : null;
    if (birthday &amp;&amp; Number.isNaN(birthdayDate?.getTime())) {
      return Response.json(
        { message: "Invalid birthday format" },
        {
          status: 400,
          headers: { "x-referer": referer },
        },
      );
    }
&nbsp;
    const hashedPassword = await bcrypt.hash(password as string, 10);
&nbsp;
    const user = await prisma.users.create({
      data: {
        email: email as string,
        password: hashedPassword,
        country: country as string,
        name: name as string,
        birthday: birthdayDate,
      },
      select: {
        id: true,
        email: true,
      },
    });
&nbsp;
    await createSession(user.id.toString());
&nbsp;
    return Response.json(
      { id: user.id.toString(), email: user.email },
      {
        status: 200,
        headers: { "x-referer": referer },
      },
    );
  } catch (error) {
    if (
      error instanceof Prisma.PrismaClientKnownRequestError &amp;&amp;
      error.code === "P2002"
    ) {
      return Response.json(
        { message: "Email already registered" },
        {
          status: 409,
          headers: { "x-referer": referer },
        },
      );
    }
&nbsp;
    console.error("Registration error", error);
&nbsp;
    return Response.json(
      { message: "Internal server error" },
      {
        status: 500,
        headers: { "x-referer": referer },
      },
    );
  }
}
&nbsp;</pre></td></tr></table></pre>

                <div class='push'></div><!-- for sticky footer -->
            </div><!-- /wrapper -->
            <div class='footer quiet pad2 space-top1 center small'>
                Code coverage generated by
                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



coverage/lcov-report/api/user/register/route.ts.html [274:363]:
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
&nbsp;
    const missingFields = [
      ["email", email],
      ["password", password],
      ["country", country],
      ["name", name],
    ]
      .filter(([, value]) =&gt; !value)
      .map(([field]) =&gt; field);
&nbsp;
    if (missingFields.length &gt; 0) {
      return Response.json(
        {
          message: `Missing required fields: ${missingFields.join(", ")}`,
        },
        {
          status: 400,
          headers: { "x-referer": referer },
        },
      );
    }
&nbsp;
    const birthdayDate = birthday ? new Date(birthday) : null;
    if (birthday &amp;&amp; Number.isNaN(birthdayDate?.getTime())) {
      return Response.json(
        { message: "Invalid birthday format" },
        {
          status: 400,
          headers: { "x-referer": referer },
        },
      );
    }
&nbsp;
    const hashedPassword = await bcrypt.hash(password as string, 10);
&nbsp;
    const user = await prisma.users.create({
      data: {
        email: email as string,
        password: hashedPassword,
        country: country as string,
        name: name as string,
        birthday: birthdayDate,
      },
      select: {
        id: true,
        email: true,
      },
    });
&nbsp;
    await createSession(user.id.toString());
&nbsp;
    return Response.json(
      { id: user.id.toString(), email: user.email },
      {
        status: 200,
        headers: { "x-referer": referer },
      },
    );
  } catch (error) {
    if (
      error instanceof Prisma.PrismaClientKnownRequestError &amp;&amp;
      error.code === "P2002"
    ) {
      return Response.json(
        { message: "Email already registered" },
        {
          status: 409,
          headers: { "x-referer": referer },
        },
      );
    }
&nbsp;
    console.error("Registration error", error);
&nbsp;
    return Response.json(
      { message: "Internal server error" },
      {
        status: 500,
        headers: { "x-referer": referer },
      },
    );
  }
}
&nbsp;</pre></td></tr></table></pre>

                <div class='push'></div><!-- for sticky footer -->
            </div><!-- /wrapper -->
            <div class='footer quiet pad2 space-top1 center small'>
                Code coverage generated by
                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -



