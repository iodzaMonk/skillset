<html>
<head>
    <title>coverage/api/orders/route.ts.html</title>
    <style type="text/css" media="screen">
        #editor {
            position: absolute;
            top: 40px;
            right: 0;
            bottom: 0;
            left: 0;
        }
    </style>
</head>
<body style="font-family: 'DejaVu Sans', Arial, Helvetica, sans-serif">
<h3 style="margin-bottom: 0">coverage/api/orders/route.ts.html (<b>266</b> lines of code) (<a href="route.ts.html">raw</a>):</h3>
<div id="editor">
&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;

&lt;head&gt;
    &lt;title&gt;Code coverage report for api/orders/route.ts&lt;/title&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;../../prettify.css&quot; /&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;../../base.css&quot; /&gt;
    &lt;link rel=&quot;shortcut icon&quot; type=&quot;image/x-icon&quot; href=&quot;../../favicon.png&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt;
    &lt;style type='text/css'&gt;
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    &lt;/style&gt;
&lt;/head&gt;
    
&lt;body&gt;
&lt;div class='wrapper'&gt;
    &lt;div class='pad1'&gt;
        &lt;h1&gt;&lt;a href=&quot;../../index.html&quot;&gt;All files&lt;/a&gt; / &lt;a href=&quot;index.html&quot;&gt;api/orders&lt;/a&gt; route.ts&lt;/h1&gt;
        &lt;div class='clearfix'&gt;
            
            &lt;div class='fl pad1y space-right2'&gt;
                &lt;span class=&quot;strong&quot;&gt;100% &lt;/span&gt;
                &lt;span class=&quot;quiet&quot;&gt;Statements&lt;/span&gt;
                &lt;span class='fraction'&gt;21/21&lt;/span&gt;
            &lt;/div&gt;
        
            
            &lt;div class='fl pad1y space-right2'&gt;
                &lt;span class=&quot;strong&quot;&gt;62.5% &lt;/span&gt;
                &lt;span class=&quot;quiet&quot;&gt;Branches&lt;/span&gt;
                &lt;span class='fraction'&gt;5/8&lt;/span&gt;
            &lt;/div&gt;
        
            
            &lt;div class='fl pad1y space-right2'&gt;
                &lt;span class=&quot;strong&quot;&gt;100% &lt;/span&gt;
                &lt;span class=&quot;quiet&quot;&gt;Functions&lt;/span&gt;
                &lt;span class='fraction'&gt;2/2&lt;/span&gt;
            &lt;/div&gt;
        
            
            &lt;div class='fl pad1y space-right2'&gt;
                &lt;span class=&quot;strong&quot;&gt;100% &lt;/span&gt;
                &lt;span class=&quot;quiet&quot;&gt;Lines&lt;/span&gt;
                &lt;span class='fraction'&gt;21/21&lt;/span&gt;
            &lt;/div&gt;
        
            
        &lt;/div&gt;
        &lt;p class=&quot;quiet&quot;&gt;
            Press &lt;em&gt;n&lt;/em&gt; or &lt;em&gt;j&lt;/em&gt; to go to the next uncovered block, &lt;em&gt;b&lt;/em&gt;, &lt;em&gt;p&lt;/em&gt; or &lt;em&gt;k&lt;/em&gt; for the previous block.
        &lt;/p&gt;
        &lt;template id=&quot;filterTemplate&quot;&gt;
            &lt;div class=&quot;quiet&quot;&gt;
                Filter:
                &lt;input type=&quot;search&quot; id=&quot;fileSearch&quot;&gt;
            &lt;/div&gt;
        &lt;/template&gt;
    &lt;/div&gt;
    &lt;div class='status-line high'&gt;&lt;/div&gt;
    &lt;pre&gt;&lt;table class=&quot;coverage&quot;&gt;
&lt;tr&gt;&lt;td class=&quot;line-count quiet&quot;&gt;&lt;a name='L1'&gt;&lt;/a&gt;&lt;a href='#L1'&gt;1&lt;/a&gt;
&lt;a name='L2'&gt;&lt;/a&gt;&lt;a href='#L2'&gt;2&lt;/a&gt;
&lt;a name='L3'&gt;&lt;/a&gt;&lt;a href='#L3'&gt;3&lt;/a&gt;
&lt;a name='L4'&gt;&lt;/a&gt;&lt;a href='#L4'&gt;4&lt;/a&gt;
&lt;a name='L5'&gt;&lt;/a&gt;&lt;a href='#L5'&gt;5&lt;/a&gt;
&lt;a name='L6'&gt;&lt;/a&gt;&lt;a href='#L6'&gt;6&lt;/a&gt;
&lt;a name='L7'&gt;&lt;/a&gt;&lt;a href='#L7'&gt;7&lt;/a&gt;
&lt;a name='L8'&gt;&lt;/a&gt;&lt;a href='#L8'&gt;8&lt;/a&gt;
&lt;a name='L9'&gt;&lt;/a&gt;&lt;a href='#L9'&gt;9&lt;/a&gt;
&lt;a name='L10'&gt;&lt;/a&gt;&lt;a href='#L10'&gt;10&lt;/a&gt;
&lt;a name='L11'&gt;&lt;/a&gt;&lt;a href='#L11'&gt;11&lt;/a&gt;
&lt;a name='L12'&gt;&lt;/a&gt;&lt;a href='#L12'&gt;12&lt;/a&gt;
&lt;a name='L13'&gt;&lt;/a&gt;&lt;a href='#L13'&gt;13&lt;/a&gt;
&lt;a name='L14'&gt;&lt;/a&gt;&lt;a href='#L14'&gt;14&lt;/a&gt;
&lt;a name='L15'&gt;&lt;/a&gt;&lt;a href='#L15'&gt;15&lt;/a&gt;
&lt;a name='L16'&gt;&lt;/a&gt;&lt;a href='#L16'&gt;16&lt;/a&gt;
&lt;a name='L17'&gt;&lt;/a&gt;&lt;a href='#L17'&gt;17&lt;/a&gt;
&lt;a name='L18'&gt;&lt;/a&gt;&lt;a href='#L18'&gt;18&lt;/a&gt;
&lt;a name='L19'&gt;&lt;/a&gt;&lt;a href='#L19'&gt;19&lt;/a&gt;
&lt;a name='L20'&gt;&lt;/a&gt;&lt;a href='#L20'&gt;20&lt;/a&gt;
&lt;a name='L21'&gt;&lt;/a&gt;&lt;a href='#L21'&gt;21&lt;/a&gt;
&lt;a name='L22'&gt;&lt;/a&gt;&lt;a href='#L22'&gt;22&lt;/a&gt;
&lt;a name='L23'&gt;&lt;/a&gt;&lt;a href='#L23'&gt;23&lt;/a&gt;
&lt;a name='L24'&gt;&lt;/a&gt;&lt;a href='#L24'&gt;24&lt;/a&gt;
&lt;a name='L25'&gt;&lt;/a&gt;&lt;a href='#L25'&gt;25&lt;/a&gt;
&lt;a name='L26'&gt;&lt;/a&gt;&lt;a href='#L26'&gt;26&lt;/a&gt;
&lt;a name='L27'&gt;&lt;/a&gt;&lt;a href='#L27'&gt;27&lt;/a&gt;
&lt;a name='L28'&gt;&lt;/a&gt;&lt;a href='#L28'&gt;28&lt;/a&gt;
&lt;a name='L29'&gt;&lt;/a&gt;&lt;a href='#L29'&gt;29&lt;/a&gt;
&lt;a name='L30'&gt;&lt;/a&gt;&lt;a href='#L30'&gt;30&lt;/a&gt;
&lt;a name='L31'&gt;&lt;/a&gt;&lt;a href='#L31'&gt;31&lt;/a&gt;
&lt;a name='L32'&gt;&lt;/a&gt;&lt;a href='#L32'&gt;32&lt;/a&gt;
&lt;a name='L33'&gt;&lt;/a&gt;&lt;a href='#L33'&gt;33&lt;/a&gt;
&lt;a name='L34'&gt;&lt;/a&gt;&lt;a href='#L34'&gt;34&lt;/a&gt;
&lt;a name='L35'&gt;&lt;/a&gt;&lt;a href='#L35'&gt;35&lt;/a&gt;
&lt;a name='L36'&gt;&lt;/a&gt;&lt;a href='#L36'&gt;36&lt;/a&gt;
&lt;a name='L37'&gt;&lt;/a&gt;&lt;a href='#L37'&gt;37&lt;/a&gt;
&lt;a name='L38'&gt;&lt;/a&gt;&lt;a href='#L38'&gt;38&lt;/a&gt;
&lt;a name='L39'&gt;&lt;/a&gt;&lt;a href='#L39'&gt;39&lt;/a&gt;
&lt;a name='L40'&gt;&lt;/a&gt;&lt;a href='#L40'&gt;40&lt;/a&gt;
&lt;a name='L41'&gt;&lt;/a&gt;&lt;a href='#L41'&gt;41&lt;/a&gt;
&lt;a name='L42'&gt;&lt;/a&gt;&lt;a href='#L42'&gt;42&lt;/a&gt;
&lt;a name='L43'&gt;&lt;/a&gt;&lt;a href='#L43'&gt;43&lt;/a&gt;
&lt;a name='L44'&gt;&lt;/a&gt;&lt;a href='#L44'&gt;44&lt;/a&gt;
&lt;a name='L45'&gt;&lt;/a&gt;&lt;a href='#L45'&gt;45&lt;/a&gt;
&lt;a name='L46'&gt;&lt;/a&gt;&lt;a href='#L46'&gt;46&lt;/a&gt;
&lt;a name='L47'&gt;&lt;/a&gt;&lt;a href='#L47'&gt;47&lt;/a&gt;
&lt;a name='L48'&gt;&lt;/a&gt;&lt;a href='#L48'&gt;48&lt;/a&gt;
&lt;a name='L49'&gt;&lt;/a&gt;&lt;a href='#L49'&gt;49&lt;/a&gt;
&lt;a name='L50'&gt;&lt;/a&gt;&lt;a href='#L50'&gt;50&lt;/a&gt;
&lt;a name='L51'&gt;&lt;/a&gt;&lt;a href='#L51'&gt;51&lt;/a&gt;
&lt;a name='L52'&gt;&lt;/a&gt;&lt;a href='#L52'&gt;52&lt;/a&gt;
&lt;a name='L53'&gt;&lt;/a&gt;&lt;a href='#L53'&gt;53&lt;/a&gt;
&lt;a name='L54'&gt;&lt;/a&gt;&lt;a href='#L54'&gt;54&lt;/a&gt;
&lt;a name='L55'&gt;&lt;/a&gt;&lt;a href='#L55'&gt;55&lt;/a&gt;
&lt;a name='L56'&gt;&lt;/a&gt;&lt;a href='#L56'&gt;56&lt;/a&gt;
&lt;a name='L57'&gt;&lt;/a&gt;&lt;a href='#L57'&gt;57&lt;/a&gt;
&lt;a name='L58'&gt;&lt;/a&gt;&lt;a href='#L58'&gt;58&lt;/a&gt;
&lt;a name='L59'&gt;&lt;/a&gt;&lt;a href='#L59'&gt;59&lt;/a&gt;
&lt;a name='L60'&gt;&lt;/a&gt;&lt;a href='#L60'&gt;60&lt;/a&gt;
&lt;a name='L61'&gt;&lt;/a&gt;&lt;a href='#L61'&gt;61&lt;/a&gt;
&lt;a name='L62'&gt;&lt;/a&gt;&lt;a href='#L62'&gt;62&lt;/a&gt;
&lt;a name='L63'&gt;&lt;/a&gt;&lt;a href='#L63'&gt;63&lt;/a&gt;
&lt;a name='L64'&gt;&lt;/a&gt;&lt;a href='#L64'&gt;64&lt;/a&gt;
&lt;a name='L65'&gt;&lt;/a&gt;&lt;a href='#L65'&gt;65&lt;/a&gt;
&lt;a name='L66'&gt;&lt;/a&gt;&lt;a href='#L66'&gt;66&lt;/a&gt;&lt;/td&gt;&lt;td class=&quot;line-coverage quiet&quot;&gt;&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;2x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;2x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;2x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;2x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;2x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;2x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/td&gt;&lt;td class=&quot;text&quot;&gt;&lt;pre class=&quot;prettyprint lang-js&quot;&gt;import { headers } from &quot;next/headers&quot;;
import { prisma } from &quot;@/lib/prisma&quot;;
import { NextResponse } from &quot;next/server&quot;;
import { Resend } from &quot;resend&quot;;
export async function POST(request: Request) {
  const headersList = await headers();
  const referer = headersList.get(&quot;referer&quot;) ?? &lt;span class=&quot;branch-1 cbranch-no&quot; title=&quot;branch not covered&quot; &gt;&quot;&quot;;&lt;/span&gt;
  const resend = new Resend(process.env.EMAIL_API!);
  try {
    const body = await request.json();
    const { description, prof_id, productId, userId } = body;
    const professional = await prisma.users.findUnique({
      where: { id: prof_id },
    });
    const clientName = await prisma.users.findUnique({
      where: { id: userId },
      select: { name: true },
    });
    const order = await prisma.commands.create({
      data: {
        client_id: userId,
        prof_id: prof_id,
        product_id: productId,
        description: description,
        date: new Date(),
      },
    });
    const mailContent = `Hello, you have a new order with the following details:\n\nDescription: ${description}\nProduct ID: ${productId}\nFrom client: ${clientName?.name || &lt;span class=&quot;branch-1 cbranch-no&quot; title=&quot;branch not covered&quot; &gt;&quot;Unknown&quot;}&lt;/span&gt;`;
    await resend.emails.send({
      from: &quot;onboarding@resend.dev&quot;,
      to: professional?.email || &quot;bramomoh06@gmail.com&quot;,
      subject: &quot;New Order Received&quot;,
      html: `&amp;lt;p&amp;gt;${mailContent}&amp;lt;/p&amp;gt;`,
    });
    return NextResponse.json(
      { id: order.id, message: &quot;Order processed successfully&quot; },
      { status: 201, headers: { &quot;x-referer&quot;: referer } },
    );
  } catch (error) {
    console.error(&quot;Error processing order:&quot;, error);
    return NextResponse.json(
      { message: &quot;Failed to process order&quot; },
      { status: 500, headers: { &quot;x-referer&quot;: referer } },
    );
  }
}
&amp;nbsp;
export async function GET() {
  const headersList = await headers();
  const referer = headersList.get(&quot;referer&quot;) ?? &lt;span class=&quot;branch-1 cbranch-no&quot; title=&quot;branch not covered&quot; &gt;&quot;&quot;;&lt;/span&gt;
&amp;nbsp;
  try {
    const orders = await prisma.commands.findMany();
    return NextResponse.json(
      { data: orders },
      { status: 200, headers: { &quot;x-referer&quot;: referer } },
    );
  } catch (error) {
    console.error(&quot;Error fetching orders:&quot;, error);
    return NextResponse.json(
      { message: &quot;Failed to fetch orders&quot; },
      { status: 500, headers: { &quot;x-referer&quot;: referer } },
    );
  }
}
&amp;nbsp;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/pre&gt;

                &lt;div class='push'&gt;&lt;/div&gt;&lt;!-- for sticky footer --&gt;
            &lt;/div&gt;&lt;!-- /wrapper --&gt;
            &lt;div class='footer quiet pad2 space-top1 center small'&gt;
                Code coverage generated by
                &lt;a href=&quot;https://istanbul.js.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;istanbul&lt;/a&gt;
                at 2025-12-05T18:46:52.030Z
            &lt;/div&gt;
        &lt;script src=&quot;../../prettify.js&quot;&gt;&lt;/script&gt;
        &lt;script&gt;
            window.onload = function () {
                prettyPrint();
            };
        &lt;/script&gt;
        &lt;script src=&quot;../../sorter.js&quot;&gt;&lt;/script&gt;
        &lt;script src=&quot;../../block-navigation.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
    </div>
<script src="https://www.zeljkoobrenovic.com/tools/common/lib/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    editor.session.setMode("ace/mode/html");
    editor.setTheme("ace/theme/xcode");
    editor.setReadOnly(true);
    editor.setOption("wrap", true);
    editor.setPrintMarginColumn(120);
</script>
</body>
