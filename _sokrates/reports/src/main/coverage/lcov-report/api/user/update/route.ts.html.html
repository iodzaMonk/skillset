<html>
<head>
    <title>coverage/lcov-report/api/user/update/route.ts.html</title>
    <style type="text/css" media="screen">
        #editor {
            position: absolute;
            top: 40px;
            right: 0;
            bottom: 0;
            left: 0;
        }
    </style>
</head>
<body style="font-family: 'DejaVu Sans', Arial, Helvetica, sans-serif">
<h3 style="margin-bottom: 0">coverage/lcov-report/api/user/update/route.ts.html (<b>332</b> lines of code) (<a href="route.ts.html">raw</a>):</h3>
<div id="editor">
&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;

&lt;head&gt;
    &lt;title&gt;Code coverage report for api/user/update/route.ts&lt;/title&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;../../../prettify.css&quot; /&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;../../../base.css&quot; /&gt;
    &lt;link rel=&quot;shortcut icon&quot; type=&quot;image/x-icon&quot; href=&quot;../../../favicon.png&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt;
    &lt;style type='text/css'&gt;
        .coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    &lt;/style&gt;
&lt;/head&gt;
    
&lt;body&gt;
&lt;div class='wrapper'&gt;
    &lt;div class='pad1'&gt;
        &lt;h1&gt;&lt;a href=&quot;../../../index.html&quot;&gt;All files&lt;/a&gt; / &lt;a href=&quot;index.html&quot;&gt;api/user/update&lt;/a&gt; route.ts&lt;/h1&gt;
        &lt;div class='clearfix'&gt;
            
            &lt;div class='fl pad1y space-right2'&gt;
                &lt;span class=&quot;strong&quot;&gt;100% &lt;/span&gt;
                &lt;span class=&quot;quiet&quot;&gt;Statements&lt;/span&gt;
                &lt;span class='fraction'&gt;87/87&lt;/span&gt;
            &lt;/div&gt;
        
            
            &lt;div class='fl pad1y space-right2'&gt;
                &lt;span class=&quot;strong&quot;&gt;83.33% &lt;/span&gt;
                &lt;span class=&quot;quiet&quot;&gt;Branches&lt;/span&gt;
                &lt;span class='fraction'&gt;10/12&lt;/span&gt;
            &lt;/div&gt;
        
            
            &lt;div class='fl pad1y space-right2'&gt;
                &lt;span class=&quot;strong&quot;&gt;100% &lt;/span&gt;
                &lt;span class=&quot;quiet&quot;&gt;Functions&lt;/span&gt;
                &lt;span class='fraction'&gt;1/1&lt;/span&gt;
            &lt;/div&gt;
        
            
            &lt;div class='fl pad1y space-right2'&gt;
                &lt;span class=&quot;strong&quot;&gt;100% &lt;/span&gt;
                &lt;span class=&quot;quiet&quot;&gt;Lines&lt;/span&gt;
                &lt;span class='fraction'&gt;87/87&lt;/span&gt;
            &lt;/div&gt;
        
            
        &lt;/div&gt;
        &lt;p class=&quot;quiet&quot;&gt;
            Press &lt;em&gt;n&lt;/em&gt; or &lt;em&gt;j&lt;/em&gt; to go to the next uncovered block, &lt;em&gt;b&lt;/em&gt;, &lt;em&gt;p&lt;/em&gt; or &lt;em&gt;k&lt;/em&gt; for the previous block.
        &lt;/p&gt;
        &lt;template id=&quot;filterTemplate&quot;&gt;
            &lt;div class=&quot;quiet&quot;&gt;
                Filter:
                &lt;input type=&quot;search&quot; id=&quot;fileSearch&quot;&gt;
            &lt;/div&gt;
        &lt;/template&gt;
    &lt;/div&gt;
    &lt;div class='status-line high'&gt;&lt;/div&gt;
    &lt;pre&gt;&lt;table class=&quot;coverage&quot;&gt;
&lt;tr&gt;&lt;td class=&quot;line-count quiet&quot;&gt;&lt;a name='L1'&gt;&lt;/a&gt;&lt;a href='#L1'&gt;1&lt;/a&gt;
&lt;a name='L2'&gt;&lt;/a&gt;&lt;a href='#L2'&gt;2&lt;/a&gt;
&lt;a name='L3'&gt;&lt;/a&gt;&lt;a href='#L3'&gt;3&lt;/a&gt;
&lt;a name='L4'&gt;&lt;/a&gt;&lt;a href='#L4'&gt;4&lt;/a&gt;
&lt;a name='L5'&gt;&lt;/a&gt;&lt;a href='#L5'&gt;5&lt;/a&gt;
&lt;a name='L6'&gt;&lt;/a&gt;&lt;a href='#L6'&gt;6&lt;/a&gt;
&lt;a name='L7'&gt;&lt;/a&gt;&lt;a href='#L7'&gt;7&lt;/a&gt;
&lt;a name='L8'&gt;&lt;/a&gt;&lt;a href='#L8'&gt;8&lt;/a&gt;
&lt;a name='L9'&gt;&lt;/a&gt;&lt;a href='#L9'&gt;9&lt;/a&gt;
&lt;a name='L10'&gt;&lt;/a&gt;&lt;a href='#L10'&gt;10&lt;/a&gt;
&lt;a name='L11'&gt;&lt;/a&gt;&lt;a href='#L11'&gt;11&lt;/a&gt;
&lt;a name='L12'&gt;&lt;/a&gt;&lt;a href='#L12'&gt;12&lt;/a&gt;
&lt;a name='L13'&gt;&lt;/a&gt;&lt;a href='#L13'&gt;13&lt;/a&gt;
&lt;a name='L14'&gt;&lt;/a&gt;&lt;a href='#L14'&gt;14&lt;/a&gt;
&lt;a name='L15'&gt;&lt;/a&gt;&lt;a href='#L15'&gt;15&lt;/a&gt;
&lt;a name='L16'&gt;&lt;/a&gt;&lt;a href='#L16'&gt;16&lt;/a&gt;
&lt;a name='L17'&gt;&lt;/a&gt;&lt;a href='#L17'&gt;17&lt;/a&gt;
&lt;a name='L18'&gt;&lt;/a&gt;&lt;a href='#L18'&gt;18&lt;/a&gt;
&lt;a name='L19'&gt;&lt;/a&gt;&lt;a href='#L19'&gt;19&lt;/a&gt;
&lt;a name='L20'&gt;&lt;/a&gt;&lt;a href='#L20'&gt;20&lt;/a&gt;
&lt;a name='L21'&gt;&lt;/a&gt;&lt;a href='#L21'&gt;21&lt;/a&gt;
&lt;a name='L22'&gt;&lt;/a&gt;&lt;a href='#L22'&gt;22&lt;/a&gt;
&lt;a name='L23'&gt;&lt;/a&gt;&lt;a href='#L23'&gt;23&lt;/a&gt;
&lt;a name='L24'&gt;&lt;/a&gt;&lt;a href='#L24'&gt;24&lt;/a&gt;
&lt;a name='L25'&gt;&lt;/a&gt;&lt;a href='#L25'&gt;25&lt;/a&gt;
&lt;a name='L26'&gt;&lt;/a&gt;&lt;a href='#L26'&gt;26&lt;/a&gt;
&lt;a name='L27'&gt;&lt;/a&gt;&lt;a href='#L27'&gt;27&lt;/a&gt;
&lt;a name='L28'&gt;&lt;/a&gt;&lt;a href='#L28'&gt;28&lt;/a&gt;
&lt;a name='L29'&gt;&lt;/a&gt;&lt;a href='#L29'&gt;29&lt;/a&gt;
&lt;a name='L30'&gt;&lt;/a&gt;&lt;a href='#L30'&gt;30&lt;/a&gt;
&lt;a name='L31'&gt;&lt;/a&gt;&lt;a href='#L31'&gt;31&lt;/a&gt;
&lt;a name='L32'&gt;&lt;/a&gt;&lt;a href='#L32'&gt;32&lt;/a&gt;
&lt;a name='L33'&gt;&lt;/a&gt;&lt;a href='#L33'&gt;33&lt;/a&gt;
&lt;a name='L34'&gt;&lt;/a&gt;&lt;a href='#L34'&gt;34&lt;/a&gt;
&lt;a name='L35'&gt;&lt;/a&gt;&lt;a href='#L35'&gt;35&lt;/a&gt;
&lt;a name='L36'&gt;&lt;/a&gt;&lt;a href='#L36'&gt;36&lt;/a&gt;
&lt;a name='L37'&gt;&lt;/a&gt;&lt;a href='#L37'&gt;37&lt;/a&gt;
&lt;a name='L38'&gt;&lt;/a&gt;&lt;a href='#L38'&gt;38&lt;/a&gt;
&lt;a name='L39'&gt;&lt;/a&gt;&lt;a href='#L39'&gt;39&lt;/a&gt;
&lt;a name='L40'&gt;&lt;/a&gt;&lt;a href='#L40'&gt;40&lt;/a&gt;
&lt;a name='L41'&gt;&lt;/a&gt;&lt;a href='#L41'&gt;41&lt;/a&gt;
&lt;a name='L42'&gt;&lt;/a&gt;&lt;a href='#L42'&gt;42&lt;/a&gt;
&lt;a name='L43'&gt;&lt;/a&gt;&lt;a href='#L43'&gt;43&lt;/a&gt;
&lt;a name='L44'&gt;&lt;/a&gt;&lt;a href='#L44'&gt;44&lt;/a&gt;
&lt;a name='L45'&gt;&lt;/a&gt;&lt;a href='#L45'&gt;45&lt;/a&gt;
&lt;a name='L46'&gt;&lt;/a&gt;&lt;a href='#L46'&gt;46&lt;/a&gt;
&lt;a name='L47'&gt;&lt;/a&gt;&lt;a href='#L47'&gt;47&lt;/a&gt;
&lt;a name='L48'&gt;&lt;/a&gt;&lt;a href='#L48'&gt;48&lt;/a&gt;
&lt;a name='L49'&gt;&lt;/a&gt;&lt;a href='#L49'&gt;49&lt;/a&gt;
&lt;a name='L50'&gt;&lt;/a&gt;&lt;a href='#L50'&gt;50&lt;/a&gt;
&lt;a name='L51'&gt;&lt;/a&gt;&lt;a href='#L51'&gt;51&lt;/a&gt;
&lt;a name='L52'&gt;&lt;/a&gt;&lt;a href='#L52'&gt;52&lt;/a&gt;
&lt;a name='L53'&gt;&lt;/a&gt;&lt;a href='#L53'&gt;53&lt;/a&gt;
&lt;a name='L54'&gt;&lt;/a&gt;&lt;a href='#L54'&gt;54&lt;/a&gt;
&lt;a name='L55'&gt;&lt;/a&gt;&lt;a href='#L55'&gt;55&lt;/a&gt;
&lt;a name='L56'&gt;&lt;/a&gt;&lt;a href='#L56'&gt;56&lt;/a&gt;
&lt;a name='L57'&gt;&lt;/a&gt;&lt;a href='#L57'&gt;57&lt;/a&gt;
&lt;a name='L58'&gt;&lt;/a&gt;&lt;a href='#L58'&gt;58&lt;/a&gt;
&lt;a name='L59'&gt;&lt;/a&gt;&lt;a href='#L59'&gt;59&lt;/a&gt;
&lt;a name='L60'&gt;&lt;/a&gt;&lt;a href='#L60'&gt;60&lt;/a&gt;
&lt;a name='L61'&gt;&lt;/a&gt;&lt;a href='#L61'&gt;61&lt;/a&gt;
&lt;a name='L62'&gt;&lt;/a&gt;&lt;a href='#L62'&gt;62&lt;/a&gt;
&lt;a name='L63'&gt;&lt;/a&gt;&lt;a href='#L63'&gt;63&lt;/a&gt;
&lt;a name='L64'&gt;&lt;/a&gt;&lt;a href='#L64'&gt;64&lt;/a&gt;
&lt;a name='L65'&gt;&lt;/a&gt;&lt;a href='#L65'&gt;65&lt;/a&gt;
&lt;a name='L66'&gt;&lt;/a&gt;&lt;a href='#L66'&gt;66&lt;/a&gt;
&lt;a name='L67'&gt;&lt;/a&gt;&lt;a href='#L67'&gt;67&lt;/a&gt;
&lt;a name='L68'&gt;&lt;/a&gt;&lt;a href='#L68'&gt;68&lt;/a&gt;
&lt;a name='L69'&gt;&lt;/a&gt;&lt;a href='#L69'&gt;69&lt;/a&gt;
&lt;a name='L70'&gt;&lt;/a&gt;&lt;a href='#L70'&gt;70&lt;/a&gt;
&lt;a name='L71'&gt;&lt;/a&gt;&lt;a href='#L71'&gt;71&lt;/a&gt;
&lt;a name='L72'&gt;&lt;/a&gt;&lt;a href='#L72'&gt;72&lt;/a&gt;
&lt;a name='L73'&gt;&lt;/a&gt;&lt;a href='#L73'&gt;73&lt;/a&gt;
&lt;a name='L74'&gt;&lt;/a&gt;&lt;a href='#L74'&gt;74&lt;/a&gt;
&lt;a name='L75'&gt;&lt;/a&gt;&lt;a href='#L75'&gt;75&lt;/a&gt;
&lt;a name='L76'&gt;&lt;/a&gt;&lt;a href='#L76'&gt;76&lt;/a&gt;
&lt;a name='L77'&gt;&lt;/a&gt;&lt;a href='#L77'&gt;77&lt;/a&gt;
&lt;a name='L78'&gt;&lt;/a&gt;&lt;a href='#L78'&gt;78&lt;/a&gt;
&lt;a name='L79'&gt;&lt;/a&gt;&lt;a href='#L79'&gt;79&lt;/a&gt;
&lt;a name='L80'&gt;&lt;/a&gt;&lt;a href='#L80'&gt;80&lt;/a&gt;
&lt;a name='L81'&gt;&lt;/a&gt;&lt;a href='#L81'&gt;81&lt;/a&gt;
&lt;a name='L82'&gt;&lt;/a&gt;&lt;a href='#L82'&gt;82&lt;/a&gt;
&lt;a name='L83'&gt;&lt;/a&gt;&lt;a href='#L83'&gt;83&lt;/a&gt;
&lt;a name='L84'&gt;&lt;/a&gt;&lt;a href='#L84'&gt;84&lt;/a&gt;
&lt;a name='L85'&gt;&lt;/a&gt;&lt;a href='#L85'&gt;85&lt;/a&gt;
&lt;a name='L86'&gt;&lt;/a&gt;&lt;a href='#L86'&gt;86&lt;/a&gt;
&lt;a name='L87'&gt;&lt;/a&gt;&lt;a href='#L87'&gt;87&lt;/a&gt;
&lt;a name='L88'&gt;&lt;/a&gt;&lt;a href='#L88'&gt;88&lt;/a&gt;&lt;/td&gt;&lt;td class=&quot;line-coverage quiet&quot;&gt;&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;5x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;5x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;5x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;5x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;5x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;5x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;5x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;5x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;5x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;4x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;5x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;2x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;2x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;2x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;2x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;5x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/td&gt;&lt;td class=&quot;text&quot;&gt;&lt;pre class=&quot;prettyprint lang-js&quot;&gt;import { headers } from &quot;next/headers&quot;;
import bcrypt from &quot;bcryptjs&quot;;
import { Prisma } from &quot;@prisma/client&quot;;
import { prisma } from &quot;@/lib/prisma&quot;;
import type { UserBody } from &quot;@/types/UserBody&quot;;
import { getCurrentUser } from &quot;@/app/lib/user&quot;;
&amp;nbsp;
export async function PATCH(req: Request) {
  const headersList = await headers();
  const referer = headersList.get(&lt;span class=&quot;branch-0 cbranch-no&quot; title=&quot;branch not covered&quot; &gt;&quot;referer&quot;) ?? &quot;&quot;;&lt;/span&gt;
&amp;nbsp;
  try {
    const body = (await req.json()) as UserBody;
    const { id, email, password, country, name, birthday } = &lt;span class=&quot;branch-0 cbranch-no&quot; title=&quot;branch not covered&quot; &gt;body ?? {};&lt;/span&gt;
&amp;nbsp;
    const authenticatedUser = await getCurrentUser();
    if (authenticatedUser?.id != id) {
      return Response.json(
        { message: &quot;Unauthorized: You can only update your own record.&quot; },
        { status: 400 },
      );
    }
&amp;nbsp;
    const updateData: UserBody = {
      email: email,
      country: country,
      name: name,
      birthday: birthday,
    };
&amp;nbsp;
    const hashedPassword = await bcrypt.hash(password as string, 10);
    if (hashedPassword) {
      updateData.password = hashedPassword;
    }
&amp;nbsp;
    const updatedUser = await prisma.users.update({
      where: { id: id },
      data: updateData,
    });
&amp;nbsp;
    return Response.json(
      {
        data: updatedUser,
      },
      {
        status: 200,
        headers: { &quot;x-referer&quot;: referer },
      },
    );
  } catch (error) {
    if (
      error instanceof Prisma.PrismaClientKnownRequestError &amp;amp;&amp;amp;
      error.code === &quot;P2025&quot;
    ) {
      return Response.json(
        { message: &quot;User not found&quot; },
        {
          status: 404,
          headers: { &quot;x-referer&quot;: referer },
        },
      );
    }
&amp;nbsp;
    if (
      error instanceof Prisma.PrismaClientKnownRequestError &amp;amp;&amp;amp;
      error.code === &quot;P2002&quot;
    ) {
      return Response.json(
        { message: &quot;Email already in use&quot; },
        {
          status: 409,
          headers: { &quot;x-referer&quot;: referer },
        },
      );
    }
&amp;nbsp;
    console.error(&quot;Update user error&quot;, error);
&amp;nbsp;
    return Response.json(
      { message: &quot;Internal server error&quot; },
      {
        status: 500,
        headers: { &quot;x-referer&quot;: referer },
      },
    );
  }
}
&amp;nbsp;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/pre&gt;

                &lt;div class='push'&gt;&lt;/div&gt;&lt;!-- for sticky footer --&gt;
            &lt;/div&gt;&lt;!-- /wrapper --&gt;
            &lt;div class='footer quiet pad2 space-top1 center small'&gt;
                Code coverage generated by
                &lt;a href=&quot;https://istanbul.js.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;istanbul&lt;/a&gt;
                at 2025-12-05T19:03:34.066Z
            &lt;/div&gt;
        &lt;script src=&quot;../../../prettify.js&quot;&gt;&lt;/script&gt;
        &lt;script&gt;
            window.onload = function () {
                prettyPrint();
            };
        &lt;/script&gt;
        &lt;script src=&quot;../../../sorter.js&quot;&gt;&lt;/script&gt;
        &lt;script src=&quot;../../../block-navigation.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
    </div>
<script src="https://www.zeljkoobrenovic.com/tools/common/lib/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    editor.session.setMode("ace/mode/html");
    editor.setTheme("ace/theme/xcode");
    editor.setReadOnly(true);
    editor.setOption("wrap", true);
    editor.setPrintMarginColumn(120);
</script>
</body>
