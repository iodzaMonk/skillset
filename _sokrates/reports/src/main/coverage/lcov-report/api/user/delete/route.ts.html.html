<html>
<head>
    <title>coverage/lcov-report/api/user/delete/route.ts.html</title>
    <style type="text/css" media="screen">
        #editor {
            position: absolute;
            top: 40px;
            right: 0;
            bottom: 0;
            left: 0;
        }
    </style>
</head>
<body style="font-family: 'DejaVu Sans', Arial, Helvetica, sans-serif">
<h3 style="margin-bottom: 0">coverage/lcov-report/api/user/delete/route.ts.html (<b>137</b> lines of code) (<a href="route.ts.html">raw</a>):</h3>
<div id="editor">
&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;

&lt;head&gt;
    &lt;title&gt;Code coverage report for api/user/delete/route.ts&lt;/title&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;../../../prettify.css&quot; /&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;../../../base.css&quot; /&gt;
    &lt;link rel=&quot;shortcut icon&quot; type=&quot;image/x-icon&quot; href=&quot;../../../favicon.png&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt;
    &lt;style type='text/css'&gt;
        .coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    &lt;/style&gt;
&lt;/head&gt;
    
&lt;body&gt;
&lt;div class='wrapper'&gt;
    &lt;div class='pad1'&gt;
        &lt;h1&gt;&lt;a href=&quot;../../../index.html&quot;&gt;All files&lt;/a&gt; / &lt;a href=&quot;index.html&quot;&gt;api/user/delete&lt;/a&gt; route.ts&lt;/h1&gt;
        &lt;div class='clearfix'&gt;
            
            &lt;div class='fl pad1y space-right2'&gt;
                &lt;span class=&quot;strong&quot;&gt;100% &lt;/span&gt;
                &lt;span class=&quot;quiet&quot;&gt;Statements&lt;/span&gt;
                &lt;span class='fraction'&gt;22/22&lt;/span&gt;
            &lt;/div&gt;
        
            
            &lt;div class='fl pad1y space-right2'&gt;
                &lt;span class=&quot;strong&quot;&gt;100% &lt;/span&gt;
                &lt;span class=&quot;quiet&quot;&gt;Branches&lt;/span&gt;
                &lt;span class='fraction'&gt;4/4&lt;/span&gt;
            &lt;/div&gt;
        
            
            &lt;div class='fl pad1y space-right2'&gt;
                &lt;span class=&quot;strong&quot;&gt;100% &lt;/span&gt;
                &lt;span class=&quot;quiet&quot;&gt;Functions&lt;/span&gt;
                &lt;span class='fraction'&gt;1/1&lt;/span&gt;
            &lt;/div&gt;
        
            
            &lt;div class='fl pad1y space-right2'&gt;
                &lt;span class=&quot;strong&quot;&gt;100% &lt;/span&gt;
                &lt;span class=&quot;quiet&quot;&gt;Lines&lt;/span&gt;
                &lt;span class='fraction'&gt;22/22&lt;/span&gt;
            &lt;/div&gt;
        
            
        &lt;/div&gt;
        &lt;p class=&quot;quiet&quot;&gt;
            Press &lt;em&gt;n&lt;/em&gt; or &lt;em&gt;j&lt;/em&gt; to go to the next uncovered block, &lt;em&gt;b&lt;/em&gt;, &lt;em&gt;p&lt;/em&gt; or &lt;em&gt;k&lt;/em&gt; for the previous block.
        &lt;/p&gt;
        &lt;template id=&quot;filterTemplate&quot;&gt;
            &lt;div class=&quot;quiet&quot;&gt;
                Filter:
                &lt;input type=&quot;search&quot; id=&quot;fileSearch&quot;&gt;
            &lt;/div&gt;
        &lt;/template&gt;
    &lt;/div&gt;
    &lt;div class='status-line high'&gt;&lt;/div&gt;
    &lt;pre&gt;&lt;table class=&quot;coverage&quot;&gt;
&lt;tr&gt;&lt;td class=&quot;line-count quiet&quot;&gt;&lt;a name='L1'&gt;&lt;/a&gt;&lt;a href='#L1'&gt;1&lt;/a&gt;
&lt;a name='L2'&gt;&lt;/a&gt;&lt;a href='#L2'&gt;2&lt;/a&gt;
&lt;a name='L3'&gt;&lt;/a&gt;&lt;a href='#L3'&gt;3&lt;/a&gt;
&lt;a name='L4'&gt;&lt;/a&gt;&lt;a href='#L4'&gt;4&lt;/a&gt;
&lt;a name='L5'&gt;&lt;/a&gt;&lt;a href='#L5'&gt;5&lt;/a&gt;
&lt;a name='L6'&gt;&lt;/a&gt;&lt;a href='#L6'&gt;6&lt;/a&gt;
&lt;a name='L7'&gt;&lt;/a&gt;&lt;a href='#L7'&gt;7&lt;/a&gt;
&lt;a name='L8'&gt;&lt;/a&gt;&lt;a href='#L8'&gt;8&lt;/a&gt;
&lt;a name='L9'&gt;&lt;/a&gt;&lt;a href='#L9'&gt;9&lt;/a&gt;
&lt;a name='L10'&gt;&lt;/a&gt;&lt;a href='#L10'&gt;10&lt;/a&gt;
&lt;a name='L11'&gt;&lt;/a&gt;&lt;a href='#L11'&gt;11&lt;/a&gt;
&lt;a name='L12'&gt;&lt;/a&gt;&lt;a href='#L12'&gt;12&lt;/a&gt;
&lt;a name='L13'&gt;&lt;/a&gt;&lt;a href='#L13'&gt;13&lt;/a&gt;
&lt;a name='L14'&gt;&lt;/a&gt;&lt;a href='#L14'&gt;14&lt;/a&gt;
&lt;a name='L15'&gt;&lt;/a&gt;&lt;a href='#L15'&gt;15&lt;/a&gt;
&lt;a name='L16'&gt;&lt;/a&gt;&lt;a href='#L16'&gt;16&lt;/a&gt;
&lt;a name='L17'&gt;&lt;/a&gt;&lt;a href='#L17'&gt;17&lt;/a&gt;
&lt;a name='L18'&gt;&lt;/a&gt;&lt;a href='#L18'&gt;18&lt;/a&gt;
&lt;a name='L19'&gt;&lt;/a&gt;&lt;a href='#L19'&gt;19&lt;/a&gt;
&lt;a name='L20'&gt;&lt;/a&gt;&lt;a href='#L20'&gt;20&lt;/a&gt;
&lt;a name='L21'&gt;&lt;/a&gt;&lt;a href='#L21'&gt;21&lt;/a&gt;
&lt;a name='L22'&gt;&lt;/a&gt;&lt;a href='#L22'&gt;22&lt;/a&gt;
&lt;a name='L23'&gt;&lt;/a&gt;&lt;a href='#L23'&gt;23&lt;/a&gt;&lt;/td&gt;&lt;td class=&quot;line-coverage quiet&quot;&gt;&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;2x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;2x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;2x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;2x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;1x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-yes&quot;&gt;3x&lt;/span&gt;
&lt;span class=&quot;cline-any cline-neutral&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/td&gt;&lt;td class=&quot;text&quot;&gt;&lt;pre class=&quot;prettyprint lang-js&quot;&gt;import { getCurrentUser } from &quot;@/app/lib/user&quot;;
import { deleteSession } from &quot;@/app/lib/session&quot;;
import { prisma } from &quot;@/lib/prisma&quot;;
&amp;nbsp;
export async function DELETE() {
  try {
    const user = await getCurrentUser();
    if (!user) {
      return Response.json({ message: &quot;Not authenticated&quot; }, { status: 401 });
    }
&amp;nbsp;
    await prisma.users.delete({
      where: { id: user.id },
    });
&amp;nbsp;
    await deleteSession();
    return Response.json({ message: &quot;Account deleted&quot; }, { status: 200 });
  } catch (e) {
    console.error(e);
    return Response.json({ message: &quot;Internal server error&quot; }, { status: 500 });
  }
}
&amp;nbsp;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/pre&gt;

                &lt;div class='push'&gt;&lt;/div&gt;&lt;!-- for sticky footer --&gt;
            &lt;/div&gt;&lt;!-- /wrapper --&gt;
            &lt;div class='footer quiet pad2 space-top1 center small'&gt;
                Code coverage generated by
                &lt;a href=&quot;https://istanbul.js.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;istanbul&lt;/a&gt;
                at 2025-12-05T19:03:34.066Z
            &lt;/div&gt;
        &lt;script src=&quot;../../../prettify.js&quot;&gt;&lt;/script&gt;
        &lt;script&gt;
            window.onload = function () {
                prettyPrint();
            };
        &lt;/script&gt;
        &lt;script src=&quot;../../../sorter.js&quot;&gt;&lt;/script&gt;
        &lt;script src=&quot;../../../block-navigation.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
    </div>
<script src="https://www.zeljkoobrenovic.com/tools/common/lib/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    editor.session.setMode("ace/mode/html");
    editor.setTheme("ace/theme/xcode");
    editor.setReadOnly(true);
    editor.setOption("wrap", true);
    editor.setPrintMarginColumn(120);
</script>
</body>
