<html>
<head>
    <title>app/myproduct/_components/Modal.tsx</title>
    <style type="text/css" media="screen">
        #editor {
            position: absolute;
            top: 40px;
            right: 0;
            bottom: 0;
            left: 0;
        }
    </style>
</head>
<body style="font-family: 'DejaVu Sans', Arial, Helvetica, sans-serif">
<h3 style="margin-bottom: 0">app/myproduct/_components/Modal.tsx (<b>202</b> lines of code) (<a href="Modal.tsx">raw</a>):</h3>
<div id="editor">&quot;use client&quot;;

import { FormEvent, useEffect, useState } from &quot;react&quot;;
import Image from &quot;next/image&quot;;

import { Button } from &quot;@/components/ui/button&quot;;
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from &quot;@/components/ui/select&quot;;
import {
  Dialog,
  DialogClose,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
  DialogTrigger,
} from &quot;@/components/ui/dialog&quot;;
import { Input } from &quot;@/components/ui/input&quot;;
import { Label } from &quot;@/components/ui/label&quot;;

enum Category {
  &quot;Video editing&quot; = &quot;Video editing&quot;,
  Voiceover = &quot;Voiceover&quot;,
  Design = &quot;Design&quot;,
  Drawing = &quot;Drawing&quot;,
  Fixing = &quot;Fixing&quot;,
  Music = &quot;Music&quot;,
}

const categoryOptions = Object.values(Category);

type modalProps = {
  isEditing: boolean;
  initialValues?: Partial&lt;{
    id: string;
    title: string;
    description: string;
    price: number;
    image_url: string | null;
  }&gt;;
  onSubmit: (event: FormEvent&lt;HTMLFormElement&gt;) =&gt; Promise&lt;boolean&gt;;
  isSubmitting?: boolean;
  triggerLabel?: string;
  showTrigger?: boolean;
  onClose?: () =&gt; void;
  forceOpen?: boolean;
  onFileChange?: (file: File | undefined) =&gt; void;
  filePreview?: string;
};

export default function Modal({
  isEditing,
  initialValues,
  onSubmit,
  isSubmitting = false,
  triggerLabel,
  showTrigger = true,
  onClose,
  forceOpen,
  onFileChange,
  filePreview,
}: modalProps) {
  const [open, setOpen] = useState(false);

  useEffect(() =&gt; {
    if (initialValues) {
      setOpen(true);
    }
  }, [initialValues]);

  useEffect(() =&gt; {
    if (forceOpen) {
      setOpen(true);
    }
  }, [forceOpen]);

  const handleOpenChange = (nextOpen: boolean) =&gt; {
    setOpen(nextOpen);
    if (!nextOpen) {
      onClose?.();
    }
  };

  const actionLabel = triggerLabel ?? (isEditing ? &quot;Modify&quot; : &quot;Create&quot;);
  const formKey = initialValues?.id ?? (isEditing ? &quot;edit&quot; : &quot;create&quot;);

  return (
    &lt;Dialog open={open} onOpenChange={handleOpenChange}&gt;
      {showTrigger &amp;&amp; (
        &lt;DialogTrigger asChild&gt;
          &lt;Button variant={isEditing ? &quot;update&quot; : &quot;success&quot;} type=&quot;button&quot;&gt;
            {actionLabel}
          &lt;/Button&gt;
        &lt;/DialogTrigger&gt;
      )}
      &lt;DialogContent className=&quot;sm:max-w-[425px]&quot;&gt;
        &lt;form
          key={formKey}
          onSubmit={async (event) =&gt; {
            const success = await onSubmit(event);
            if (success) {
              setOpen(false);
            }
          }}
          className=&quot;space-y-6&quot;
        &gt;
          &lt;DialogHeader&gt;
            &lt;DialogTitle&gt;{isEditing ? &quot;Edit&quot; : &quot;Create&quot;} post&lt;/DialogTitle&gt;
            &lt;DialogDescription&gt;
              {isEditing ? &quot;Make changes to&quot; : &quot;Create&quot;} your profile here.
              Click {isEditing ? &quot;save&quot; : &quot;create&quot;} when you&amp;apos;re done.
            &lt;/DialogDescription&gt;
          &lt;/DialogHeader&gt;
          &lt;div className=&quot;grid gap-4&quot;&gt;
            &lt;div className=&quot;grid gap-3&quot;&gt;
              &lt;Label htmlFor=&quot;title&quot;&gt;Title&lt;/Label&gt;
              &lt;Input
                name=&quot;title&quot;
                id=&quot;title&quot;
                required
                defaultValue={initialValues?.title ?? &quot;&quot;}
              /&gt;
            &lt;/div&gt;
            &lt;div className=&quot;grid gap-3&quot;&gt;
              &lt;Label htmlFor=&quot;description&quot;&gt;Description&lt;/Label&gt;
              &lt;Input
                name=&quot;description&quot;
                id=&quot;description&quot;
                required
                defaultValue={initialValues?.description ?? &quot;&quot;}
              /&gt;
            &lt;/div&gt;
            &lt;div className=&quot;grid gap-3&quot;&gt;
              &lt;Label htmlFor=&quot;price&quot;&gt;Price&lt;/Label&gt;
              &lt;Input
                name=&quot;price&quot;
                id=&quot;price&quot;
                type=&quot;number&quot;
                min=&quot;0&quot;
                step=&quot;0.01&quot;
                required
                defaultValue={
                  initialValues?.price !== undefined ? initialValues.price : &quot;&quot;
                }
              /&gt;
            &lt;/div&gt;
            &lt;div className=&quot;grid gap-3&quot;&gt;
              &lt;Label htmlFor=&quot;image&quot;&gt;Image&lt;/Label&gt;
              &lt;Input
                name=&quot;image&quot;
                id=&quot;image&quot;
                type=&quot;file&quot;
                onChange={(event) =&gt; onFileChange?.(event.target.files?.[0])}
              /&gt;
              {filePreview ? (
                &lt;Image
                  src={filePreview}
                  alt=&quot;Selected preview&quot;
                  width={128}
                  height={128}
                  className=&quot;w-full rounded-md object-cover&quot;
                /&gt;
              ) : initialValues?.image_url ? (
                &lt;Image
                  src={initialValues.image_url}
                  alt={initialValues.title ?? &quot;Current product image&quot;}
                  width={128}
                  height={128}
                  className=&quot;w-full rounded-md object-cover&quot;
                /&gt;
              ) : null}
            &lt;/div&gt;
            &lt;div className=&quot;grid gap-3&quot;&gt;
              &lt;Label htmlFor=&quot;category&quot;&gt;Category&lt;/Label&gt;
              &lt;Select name=&quot;category&quot;&gt;
                &lt;SelectTrigger className=&quot;w-full&quot;&gt;
                  &lt;SelectValue placeholder=&quot;Select a category&quot; /&gt;
                &lt;/SelectTrigger&gt;
                &lt;SelectContent&gt;
                  {categoryOptions.map((category) =&gt; (
                    &lt;SelectItem key={category} value={category}&gt;
                      {category}
                    &lt;/SelectItem&gt;
                  ))}
                &lt;/SelectContent&gt;
              &lt;/Select&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          &lt;DialogFooter&gt;
            &lt;DialogClose asChild&gt;
              &lt;Button type=&quot;button&quot; variant=&quot;cancel&quot;&gt;
                Cancel
              &lt;/Button&gt;
            &lt;/DialogClose&gt;
            &lt;Button type=&quot;submit&quot; variant=&quot;success&quot; disabled={isSubmitting}&gt;
              {isSubmitting
                ? &quot;Saving...&quot;
                : isEditing
                  ? &quot;Save changes&quot;
                  : &quot;Create&quot;}
            &lt;/Button&gt;
          &lt;/DialogFooter&gt;
        &lt;/form&gt;
      &lt;/DialogContent&gt;
    &lt;/Dialog&gt;
  );
}
</div>
<script src="https://www.zeljkoobrenovic.com/tools/common/lib/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    editor.session.setMode("ace/mode/typescript");
    editor.setTheme("ace/theme/xcode");
    editor.setReadOnly(true);
    editor.setOption("wrap", true);
    editor.setPrintMarginColumn(120);
</script>
</body>
