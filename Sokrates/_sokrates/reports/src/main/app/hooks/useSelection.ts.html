<html>
<head>
    <title>app/hooks/useSelection.ts</title>
    <style type="text/css" media="screen">
        #editor {
            position: absolute;
            top: 40px;
            right: 0;
            bottom: 0;
            left: 0;
        }
    </style>
</head>
<body style="font-family: 'DejaVu Sans', Arial, Helvetica, sans-serif">
<h3 style="margin-bottom: 0">app/hooks/useSelection.ts (<b>43</b> lines of code) (<a href="useSelection.ts">raw</a>):</h3>
<div id="editor">import { useCallback, useEffect, useMemo, useState } from &quot;react&quot;;

export function useSelection(itemIds: string[]) {
  const [selectedIds, setSelectedIds] = useState&lt;string[]&gt;([]);

  // Memoize valid IDs to avoid unnecessary re-renders
  const validIds = useMemo(() =&gt; itemIds, [itemIds]);

  // Clean up selectedIds when items change
  useEffect(() =&gt; {
    setSelectedIds((current) =&gt; {
      const newSelected = current.filter((id) =&gt; validIds.includes(id));
      if (
        newSelected.length !== current.length ||
        newSelected.some((id, index) =&gt; id !== current[index])
      ) {
        return newSelected;
      }
      return current;
    });
  }, [validIds]);

  const toggleSelection = useCallback((id: string | undefined) =&gt; {
    if (!id) return;

    setSelectedIds((current) =&gt; {
      if (current.includes(id)) {
        return current.filter((currentId) =&gt; currentId !== id);
      }
      return [...current, id];
    });
  }, []);

  const clearSelection = useCallback(() =&gt; {
    setSelectedIds([]);
  }, []);

  const selectAll = useCallback(() =&gt; {
    setSelectedIds(validIds);
  }, [validIds]);

  return {
    selectedIds,
    setSelectedIds,
    toggleSelection,
    clearSelection,
    selectAll,
    count: selectedIds.length,
    allSelected: validIds.length &gt; 0 &amp;&amp; selectedIds.length === validIds.length,
    hasSelection: selectedIds.length &gt; 0,
  };
}

export type SelectionResult = ReturnType&lt;typeof useSelection&gt;;
</div>
<script src="https://www.zeljkoobrenovic.com/tools/common/lib/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    editor.session.setMode("ace/mode/typescript");
    editor.setTheme("ace/theme/xcode");
    editor.setReadOnly(true);
    editor.setOption("wrap", true);
    editor.setPrintMarginColumn(120);
</script>
</body>
