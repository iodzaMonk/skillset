<html>
<head>
    <title>export default function Auth()</title>
    <link rel="stylesheet" charset="UTF-8" href="https://d2bb1mtyn3kglb.cloudfront.net/lib/highlight/styles/docco.min.css">
    <script charset="UTF-8" type="application/javascript" src="https://d2bb1mtyn3kglb.cloudfront.net/lib/highlight/highlight.min.js"></script>
</head>
<body style="font-family: 'DejaVu Sans', Arial, Helvetica, sans-serif">
<h3 style="margin-bottom: 0">export default function Auth()</h3>
<p style="margin-top: 4px">in <i>app/auth/[slug]/page.tsx [26:312]</i></p>
<ul>
    <li><b>230</b> lines of code</li>
    <li><b>5</b> McCabe index (conditional complexity)</li>
</ul>
<pre>
<code class="tsx">
export default function Auth() {
  const { slug } = useParams&lt;{ slug: string }&gt;();
  const [country, setCountry] = useState(&quot;&quot;);
  const [birthday, setBirthday] = useState&lt;Date | null&gt;(new Date());
  const [error, setError] = useState&lt;string | null&gt;(null);
  const [isSubmitting, setIsSubmitting] = useState(false);
  const login = slug === &quot;login&quot;;

  const router = useRouter();
  const { refresh } = useAuth();

  async function onSubmit(e: React.FormEvent&lt;HTMLFormElement&gt;) {
    e.preventDefault();
    if (isSubmitting) return;

    const form = new FormData(e.currentTarget);
    setError(null);
    setIsSubmitting(true);

    try {
      if (login) {
        const payload = {
          email: form.get(&quot;email&quot;),
          password: form.get(&quot;password&quot;),
        };
        await axios.post(&quot;/api/user/login&quot;, payload);
      } else {
        const payload = {
          name: form.get(&quot;name&quot;),
          email: form.get(&quot;email&quot;),
          password: form.get(&quot;password&quot;),
          country,
          birthday,
        };
        await axios.post(&quot;/api/user/register&quot;, payload);
      }

      await refresh();
      router.push(&quot;/&quot;);
    } catch (err) {
      const message = axios.isAxiosError(err)
        ? (err.response?.data?.message ?? &quot;Something went wrong&quot;)
        : &quot;Something went wrong&quot;;
      setError(message);
    } finally {
      setIsSubmitting(false);
    }
  }

  return (
    &lt;&gt;
      {login ? (
        &lt;div className=&quot;flex w-full flex-col items-center !font-sans&quot;&gt;
          &lt;section className=&quot;w-full max-w-md px-4 md:px-0&quot;&gt;
            &lt;div className=&quot;border-border bg-surface/90 mx-auto w-full rounded-lg border shadow-lg backdrop-blur&quot;&gt;
              &lt;div className=&quot;space-y-4 p-6 sm:p-8&quot;&gt;
                &lt;h1 className=&quot;text-text text-2xl font-bold&quot;&gt;
                  Sign in to your account
                &lt;/h1&gt;

                &lt;form className=&quot;space-y-5&quot; onSubmit={onSubmit}&gt;
                  &lt;div&gt;
                    &lt;label htmlFor=&quot;email&quot; className={labelBase}&gt;
                      Your email
                    &lt;/label&gt;
                    &lt;input
                      type=&quot;email&quot;
                      name=&quot;email&quot;
                      placeholder=&quot;name@company.com&quot;
                      className={inputBase}
                      required
                      autoComplete=&quot;email&quot;
                    /&gt;
                  &lt;/div&gt;

                  &lt;div&gt;
                    &lt;label htmlFor=&quot;password&quot; className={labelBase}&gt;
                      Password
                    &lt;/label&gt;
                    &lt;input
                      type=&quot;password&quot;
                      name=&quot;password&quot;
                      placeholder=&quot;********&quot;
                      className={inputBase}
                      required
                      autoComplete=&quot;current-password&quot;
                    /&gt;
                  &lt;/div&gt;

                  &lt;div className=&quot;flex items-center justify-between&quot;&gt;
                    &lt;label className=&quot;text-text flex items-center gap-2 text-sm&quot;&gt;
                      &lt;input
                        id=&quot;remember&quot;
                        type=&quot;checkbox&quot;
                        className=&quot;border-border bg-surface/60 text-secondary h-4 w-4 rounded focus:ring-2 focus:ring-[--color-ring] focus:outline-none&quot;
                      /&gt;
                      &lt;span className=&quot;text-text-muted&quot;&gt;Remember me&lt;/span&gt;
                    &lt;/label&gt;

                    &lt;a
                      href=&quot;#&quot;
                      className=&quot;text-accent text-sm font-medium hover:opacity-90&quot;
                    &gt;
                      Forgot password?
                    &lt;/a&gt;
                  &lt;/div&gt;

                  &lt;button
                    type=&quot;submit&quot;
                    disabled={isSubmitting}
                    className=&quot;bg-accent text-text-onAccent hover:bg-accent-hover focus:ring-ring w-full cursor-pointer rounded-md px-5 py-2.5 text-center text-sm font-semibold transition focus:ring-2 focus:outline-none disabled:cursor-not-allowed disabled:opacity-60&quot;
                  &gt;
                    Sign in
                  &lt;/button&gt;

                  {error ? &lt;p className=&quot;text-red-600&quot;&gt;{error}&lt;/p&gt; : null}

                  &lt;p className={hintText}&gt;
                    Dont have an account yet?{&quot; &quot;}
                    &lt;TransitionLink
                      href=&quot;/auth/signup&quot;
                      className=&quot;text-accent hover:opacity-90&quot;
                    &gt;
                      Sign up
                    &lt;/TransitionLink&gt;
                  &lt;/p&gt;
                &lt;/form&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/section&gt;
        &lt;/div&gt;
      ) : (
        &lt;div className=&quot;flex w-full flex-col items-center !font-sans&quot;&gt;
          &lt;section className=&quot;mb-10 w-full max-w-2xl px-4 md:px-0&quot;&gt;
            &lt;div className=&quot;border-border bg-surface/90 mx-auto w-full rounded-lg border shadow-lg backdrop-blur&quot;&gt;
              &lt;div className=&quot;space-y-6 p-6 sm:p-8&quot;&gt;
                &lt;h1 className=&quot;text-text text-2xl font-bold&quot;&gt;
                  Create your account
                &lt;/h1&gt;

                &lt;form className=&quot;space-y-6&quot; onSubmit={onSubmit}&gt;
                  &lt;div&gt;
                    &lt;label htmlFor=&quot;email&quot; className={labelBase}&gt;
                      Email address
                    &lt;/label&gt;
                    &lt;input
                      name=&quot;email&quot;
                      type=&quot;email&quot;
                      className={inputBase}
                      placeholder=&quot;you@example.com&quot;
                      required
                      autoComplete=&quot;email&quot;
                    /&gt;
                  &lt;/div&gt;

                  &lt;div&gt;
                    &lt;label htmlFor=&quot;name&quot; className={labelBase}&gt;
                      Name
                    &lt;/label&gt;
                    &lt;input
                      type=&quot;text&quot;
                      name=&quot;name&quot;
                      className={inputBase}
                      placeholder=&quot;Jane&quot;
                      required
                      autoComplete=&quot;given-name&quot;
                    /&gt;
                  &lt;/div&gt;

                  &lt;div className=&quot;grid gap-6 md:grid-cols-2&quot;&gt;
                    &lt;div&gt;
                      &lt;label htmlFor=&quot;password&quot; className={labelBase}&gt;
                        Password
                      &lt;/label&gt;
                      &lt;input
                        type=&quot;password&quot;
                        name=&quot;password&quot;
                        className={inputBase}
                        placeholder=&quot;********&quot;
                        required
                        autoComplete=&quot;new-password&quot;
                      /&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                      &lt;label htmlFor=&quot;confirmPassword&quot; className={labelBase}&gt;
                        Confirm password
                      &lt;/label&gt;
                      &lt;input
                        type=&quot;password&quot;
                        name=&quot;confirmPassword&quot;
                        className={inputBase}
                        placeholder=&quot;********&quot;
                        required
                        autoComplete=&quot;new-password&quot;
                      /&gt;
                    &lt;/div&gt;
                  &lt;/div&gt;

                  &lt;div id=&quot;countries&quot;&gt;
                    &lt;label
                      htmlFor=&quot;countries&quot;
                      className=&quot;text-text mb-2 block text-sm font-medium&quot;
                    &gt;
                      Country
                    &lt;/label&gt;

                    &lt;Select value={country} onValueChange={setCountry}&gt;
                      &lt;SelectTrigger className=&quot;bg-surface w-full&quot;&gt;
                        &lt;SelectValue placeholder=&quot;Country&quot; /&gt;
                      &lt;/SelectTrigger&gt;
                      &lt;SelectContent
                        position=&quot;popper&quot;
                        side=&quot;bottom&quot;
                        align=&quot;start&quot;
                        sideOffset={6}
                        className=&quot;border-border bg-surface text-text z-[9999] rounded-md border shadow-xl&quot;
                      &gt;
                        {countries.map((c, i) =&gt; (
                          &lt;SelectItem
                            className=&quot;data-[highlighted]:!bg-accent/20 data-[highlighted]:!text-text data-[state-checked]:!bg-accent data-[state-checked]:!text-text-onAccent cursor-pointer px-3 py-2 text-sm data-[disabled]:opacity-50&quot;
                            key={i}
                            value={c.code}
                          &gt;
                            &lt;div className=&quot;flex items-center gap-2&quot;&gt;
                              &lt;span
                                className={`fi fi-${c.code.toLowerCase()}`}
                              /&gt;
                              {c.name}
                            &lt;/div&gt;
                          &lt;/SelectItem&gt;
                        ))}
                      &lt;/SelectContent&gt;
                    &lt;/Select&gt;
                  &lt;/div&gt;

                  &lt;Datepicker
                    id=&quot;datepicker&quot;
                    onChange={setBirthday}
                    value={birthday ?? undefined}
                  /&gt;
                  &lt;input
                    type=&quot;hidden&quot;
                    name=&quot;birthday&quot;
                    value={birthday ? format(birthday, &quot;yyyy-MM-dd&quot;) : &quot;&quot;}
                  /&gt;

                  {error ? &lt;p className=&quot;text-red-600&quot;&gt;{error}&lt;/p&gt; : null}

                  &lt;div className=&quot;flex flex-wrap items-center gap-4&quot;&gt;
                    &lt;button
                      type=&quot;submit&quot;
                      disabled={isSubmitting}
                      className=&quot;bg-accent text-text-onAccent hover:bg-accent-hover focus:ring-ring cursor-pointer rounded-md px-5 py-2.5 text-sm font-semibold transition focus:ring-2 focus:outline-none disabled:cursor-not-allowed disabled:opacity-60&quot;
                    &gt;
                      Submit
                    &lt;/button&gt;

                    &lt;TransitionLink href=&quot;/auth/login&quot;&gt;
                      &lt;Button
                        color=&quot;light&quot;
                        className=&quot;border-border bg-surface text-text hover:bg-surface-2 cursor-pointer border&quot;
                      &gt;
                        Or click here to login
                      &lt;/Button&gt;
                    &lt;/TransitionLink&gt;
                  &lt;/div&gt;

                  &lt;p className={hintText}&gt;
                    By continuing you agree to our{&quot; &quot;}
                    &lt;a href=&quot;#&quot; className=&quot;text-accent hover:opacity-90&quot;&gt;
                      Terms
                    &lt;/a&gt;{&quot; &quot;}
                    and{&quot; &quot;}
                    &lt;a href=&quot;#&quot; className=&quot;text-accent hover:opacity-90&quot;&gt;
                      Privacy Policy
                    &lt;/a&gt;
                    .
                  &lt;/p&gt;
                &lt;/form&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/section&gt;
        &lt;/div&gt;
      )}
    &lt;/&gt;
  );
}

</code>
</pre>
<script>
    hljs.initHighlightingOnLoad();
</script>
</body>
